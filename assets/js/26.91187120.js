(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{372:function(t,s,n){"use strict";n.r(s);var a=n(42),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"示例-hello-world"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#示例-hello-world"}},[t._v("#")]),t._v(" 示例：Hello World")]),t._v(" "),n("h2",{attrs:{id:"你的第一个插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#你的第一个插件"}},[t._v("#")]),t._v(" 你的第一个插件")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v('本节通过Hello World这个完整的项目手把手教你掌握VS Code扩展性概念。\n在本项目中，我们会给VS Code添加一个新的命令，虽然只是用来显示"Hello World"信息。在本节的最后，你将和编辑器编辑器互动，查找用户选中的文本。')]),t._v(" "),n("h4",{attrs:{id:"预备工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#预备工作"}},[t._v("#")]),t._v(" 预备工作")]),t._v(" "),n("p",[t._v("请查看"),n("a",{attrs:{href:"/extension-authoring/extension-generator?id=%E9%A2%84%E5%85%88%E5%87%86%E5%A4%87"}},[t._v("生成插件-预备工作")])]),t._v(" "),n("h4",{attrs:{id:"生成新插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生成新插件"}},[t._v("#")]),t._v(" 生成新插件")]),t._v(" "),n("p",[t._v("请查看"),n("a",{attrs:{href:"/extension-authoring/extension-generator?id=%E8%BF%90%E8%A1%8Cyo-code%F0%9F%98%8E"}},[t._v("生成插件-运行Yo")])]),t._v(" "),n("h2",{attrs:{id:"运行插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#运行插件"}},[t._v("#")]),t._v(" 运行插件")]),t._v(" "),n("hr"),t._v(" "),n("ul",[n("li",[t._v("打开VS Code，选择"),n("code",[t._v("文件")]),t._v(">"),n("code",[t._v("打开文件夹")]),t._v("，选择你刚刚生成的项目目录")]),t._v(" "),n("li",[t._v("点击"),n("code",[t._v("F5")]),t._v("或者"),n("code",[t._v("Debug")]),t._v("按钮，然后点击"),n("code",[t._v("开始")])]),t._v(" "),n("li",[t._v("新的VS Code实例会运行在特殊环境中（"),n("code",[t._v("Extension Development Host")])]),t._v(" "),n("li",[t._v("按下"),n("code",[t._v("⇧⌘P")]),t._v("(windows "),n("code",[t._v("shift + ctrl + p")]),t._v(")，输入命令"),n("code",[t._v("Hello world")])]),t._v(" "),n("li",[t._v("恭喜！你的第一个VS Code插件执行成功了")])]),t._v(" "),n("p",[n("img",{attrs:{src:"https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-hello-world/running.png",alt:""}})]),t._v(" "),n("h2",{attrs:{id:"插件的目录结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#插件的目录结构"}},[t._v("#")]),t._v(" 插件的目录结构")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("构建完毕之后，你的插件开发目录看起来应该是这样的")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v(".\n├── .gitignore\n├── .vscode                     // VS Code 文件\n│   ├── launch.json\n│   ├── settings.json\n│   └── tasks.json\n├── .vscodeignore               // 发布插件时忽略的文件\n├── README.md\n├── src\n│   └── extension.ts            // 插件的入口（源文件）\n├── test                        // 测试文件夹\n│   ├── extension.test.ts       // extension.test.js, 如果是 JavaScript 插件的话\n│   └── index.ts                // index.js, 如果是 JavaScript 插件的话\n├── node_modules\n│   ├── vscode                  // 包含了vscode插件开发时的类型定义文件\n│   └── typescript              // typescript的编译器 (TypeScript only)\n├── out                         // 编译出口 (TypeScript only)\n│   ├── extension.js            // 插件入口\n│   ├── extension.js.map\n│   └── test\n│       ├── extension.test.js\n│       ├── extension.test.js.map\n│       ├── index.js\n│       └── index.js.map\n├── package.json                // 插件清单\n├── tsconfig.json               // jsconfig.json, 如果是 JavaScript 插件的话\n└── vsc-extension-quickstart.md // 快速上手插件开发\n")])])]),n("p",[t._v("让我们看看这些文件夹都是干什么用的：")]),t._v(" "),n("h4",{attrs:{id:"插件清单-package-json"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#插件清单-package-json"}},[t._v("#")]),t._v(" 插件清单："),n("code",[t._v("package.json")])]),t._v(" "),n("ul",[n("li",[t._v("每个VS Code插件都有"),n("code",[t._v("package.json")]),t._v("文件，文件内包含了这个插件功能和用处。")]),t._v(" "),n("li",[t._v("当项目启动时，VS Code会立即读取这个文件中的每个"),n("code",[t._v("配置(contributes)")]),t._v("部分并作出响应。")]),t._v(" "),n("li",[t._v("请阅读"),n("RouterLink",{attrs:{to:"/extensibility-reference/extension-manifest.html"}},[t._v("package.json插件清单")]),t._v("参考文档")],1),t._v(" "),n("li",[t._v("更多信息请参阅"),n("RouterLink",{attrs:{to:"/extensibility-reference/contribution-points.html"}},[t._v("package.json发布内容配置")]),t._v("参考文档")],1)]),t._v(" "),n("p",[t._v("?> 译者注：为了便于理解，"),n("code",[t._v("contribution / contributes")]),t._v("在本教程中译为"),n("strong",[t._v("发布内容配置/配置")]),t._v("，"),n("code",[t._v("contribution points")]),t._v("译为"),n("strong",[t._v("发布内容配置点/配置点")]),t._v("。")]),t._v(" "),n("p",[n("strong",[t._v("示例：基于TypeScript的pacakge.json")])]),t._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myFirstExtension"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"version"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0.0.1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"publisher"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"engines"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"vscode"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^1.5.0"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"categories"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Other"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"activationEvents"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onCommand:extension.sayHello"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"main"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./out/extension"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"contributes"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commands"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"command"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"extension.sayHello"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"title"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello World"')]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"vscode:prepublish"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tsc -p ./"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"compile"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tsc -watch -p ./"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"postinstall"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node ./node_modules/vscode/bin/install"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"test"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node ./node_modules/vscode/bin/test"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"devDependencies"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"typescript"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^2.0.3"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"vscode"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^1.5.0"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"mocha"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^2.3.3"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"@types/node"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^6.0.40"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"@types/mocha"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^2.2.32"')]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("!> 提示: 基于JavaScript的插件没有scripts部分，因为不需要编译。")]),t._v(" "),n("p",[t._v("这份"),n("code",[t._v("package.json")]),t._v("文件说了什么呢？")]),t._v(" "),n("ul",[n("li",[t._v("**配置部分(contributes)**给"),n("em",[t._v("命令面板")]),t._v("定义了一个叫做"),n("code",[t._v("Hello world")]),t._v("的入口，它会调用'extension.sayHello'。")]),t._v(" "),n("li",[t._v('当命令"extension.sayHello"调用时，执行'),n("code",[t._v("loaded")]),t._v("(激活事件)请求。")]),t._v(" "),n("li",[t._v('在"'),n("code",[t._v("./out/extension.js")]),t._v('"中，存放着我们的主文件。')])]),t._v(" "),n("p",[t._v("!> 注意：VS Code "),n("strong",[t._v("不会一启动就加载插件")]),t._v("。插件必须在"),n("code",[t._v("activationEvents")]),t._v("中描述它的启动时机，比如"),n("code",[t._v("loaded")]),t._v("事件。")]),t._v(" "),n("h4",{attrs:{id:"生成的代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生成的代码"}},[t._v("#")]),t._v(" 生成的代码")]),t._v(" "),n("p",[t._v("自动生成的代码存放在"),n("strong",[t._v("extension.ts")]),t._v("（或者"),n("strong",[t._v("extension.js")]),t._v("中）。")]),t._v(" "),n("div",{staticClass:"language-typescript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-typescript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 'vscode'模块包含了VS Code extensibility API")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 按下述方式导入这个模块")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" vscode "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vscode'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 一旦你的插件激活，vscode会立刻调用下述方法")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("activate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" vscode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExtensionContext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用console输出诊断信息(console.log)和错误(console.error)")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 下面的代码只会在你的插件激活时执行一次")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("console")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Congratulations, your extension \"my-first-extension\" is now active!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 入口命令已经在package.json文件中定义好了，现在调用registerCommand方法")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// registerCommand中的参数必须与package.json中的command保持一致")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" disposable "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vscode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commands"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerCommand")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'extension.sayHello'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 把你的代码写在这里，每次命令执行时都会调用这里的代码")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 给用户显示一个消息提示")]),t._v("\n        vscode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("showInformationMessage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello World!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subscriptions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("disposable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ul",[n("li",[t._v("每个插件都应该在主文件中注册一个"),n("code",[t._v("activate()")]),t._v("函数，因为这个函数只会调用一次。你只有"),n("code",[t._v("在package.json")]),t._v("中注册了"),n("code",[t._v("activationEvents")]),t._v("列表中的事件，激活事件才会被调用。")]),t._v(" "),n("li",[t._v("如果插件使用了系统资源(如：生成进程），则需要从主文件中导出名为"),n("code",[t._v("deactive()")]),t._v("的函数去清理释放这些资源，VS Code会在关闭时调用这个方法。")]),t._v(" "),n("li",[t._v('这个插件导入了VS Code API，然后注册了"extension.sayHello"命令和回调函数，执行后在VS Code中显示一条"Hello World!"消息。')])]),t._v(" "),n("p",[t._v("!> 注意： "),n("code",[t._v("package.json")]),t._v("的"),n("code",[t._v("contributes")]),t._v("部分给"),n("em",[t._v("命令面板")]),t._v("添加了一个调用入口。"),n("code",[t._v("extension.ts/.js")]),t._v("定义了"),n("code",[t._v("extension.sayHello")]),t._v("的实现。对于 Typescript类型的插件来说，生成的"),n("code",[t._v("out/extension.js")]),t._v("会在运行时加载。")]),t._v(" "),n("h4",{attrs:{id:"其他文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#其他文件"}},[t._v("#")]),t._v(" 其他文件")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("vscode/launch.json")]),t._v(" 告诉VS Code启用插件开发模式。它也描述了"),n("code",[t._v(".vscode/tasks.json")]),t._v("中需要Typescript编译器的预加载任务。")]),t._v(" "),n("li",[n("code",[t._v("vscode/settings.json")]),t._v(" 默认排除外部文件夹。你如果想隐藏一些文件，可以修改这个配置。")]),t._v(" "),n("li",[n("code",[t._v("gitignore")]),t._v(" - 告诉git不跟踪哪些文件。")]),t._v(" "),n("li",[n("code",[t._v("vscodeignore")]),t._v(" - 告诉打包工具，发布插件时应该忽略哪些文件。")]),t._v(" "),n("li",[n("code",[t._v("README.md")]),t._v(" - 为插件的使用用户提供良好的文档。")]),t._v(" "),n("li",[n("code",[t._v("vsc-extension-quickstart.md")]),t._v(" - 你的快速开始指南。")]),t._v(" "),n("li",[n("code",[t._v("test/extension.test.ts")]),t._v(" - 把你的单元测试放在这里，看看和VS Code API有哪些出入。")])]),t._v(" "),n("h2",{attrs:{id:"插件激活过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#插件激活过程"}},[t._v("#")]),t._v(" 插件激活过程")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("我们刚刚已经了解了开发目录下的每个文件，现在我们看看你的插件是怎么运行起来的：")]),t._v(" "),n("ol",[n("li",[t._v("插件开发环境发现了这个插件，然后读取它的"),n("code",[t._v("package.json")])]),t._v(" "),n("li",[t._v("你按下"),n("code",[t._v("ctrl shift p")]),t._v("时，"),n("em",[t._v("命令面板")]),t._v("显示出已注册的命令列表")]),t._v(" "),n("li",[t._v("在列表中你找到"),n("code",[t._v("package.json")]),t._v("中定义的"),n("code",[t._v("Hello world")]),t._v("命令入口")]),t._v(" "),n("li",[t._v("选中并执行"),n("code",[t._v("Hello world")]),t._v('，随即执行真实的"'),n("code",[t._v("extension.sayHello")]),t._v('"命令\n'),n("ul",[n("li",[t._v("创建"),n("code",[t._v('"onCommand:extension.sayHello"')]),t._v("激活事件")]),t._v(" "),n("li",[t._v("激活所有注册在"),n("code",[t._v("activationEvents")]),t._v("的事件\n"),n("ul",[n("li",[t._v("Javascript虚拟机加载"),n("code",[t._v("./out/extension.js")]),t._v("文件")]),t._v(" "),n("li",[t._v("VS Code查找导出的"),n("code",[t._v("activate")]),t._v("函数，并调用")])])])])]),t._v(" "),n("li",[t._v("调用"),n("code",[t._v('"extension.sayHello"')]),t._v("注册的函数")]),t._v(" "),n("li",[t._v('函数执行，显示出"Hello world"消息')])]),t._v(" "),n("h2",{attrs:{id:"调试插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#调试插件"}},[t._v("#")]),t._v(" 调试插件")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("直接在你的代码里打上断点就可以调试了，很简单吧。")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-hello-world/hitbp.png",alt:"调试"}})]),t._v(" "),n("p",[t._v("!> 注意：VS Code具有解析sourcemap的能力，所以你可以直接在Typescript代码中调试。")]),t._v(" "),n("p",[t._v("?>小提示：调试控制台(Debug Console)能输出所有console打印的日志。")]),t._v(" "),n("p",[t._v("查看更多关于插件"),n("RouterLink",{attrs:{to:"/extension-authoring/developing-extensions.html"}},[t._v("开发环境")]),t._v("的东西。")],1),t._v(" "),n("h2",{attrs:{id:"小小的改造"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#小小的改造"}},[t._v("#")]),t._v(" 小小的改造")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("试着修改你的"),n("code",[t._v("extension.ts")]),t._v("（或者"),n("code",[t._v("extension.js")]),t._v("）中"),n("code",[t._v("extension.sayHello")]),t._v("的实现，我们把它改造成一个对选中文本计数的功能。")]),t._v(" "),n("div",{staticClass:"language-typescript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-typescript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" disposable "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vscode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commands"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerCommand")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'extension.sayHello'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每当你执行命令，这里的代码都会执行一次")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" editor "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vscode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("activeTextEditor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 没有打开的编辑器")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" selection "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" text "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getText")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("selection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 给用户一个消息提示框")]),t._v("\n    vscode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("showInformationMessage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Selected characters: '")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" text"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("!> 当你修改了代码，你需要按"),n("kbd",[t._v("Ctrl + R")]),t._v("(macOS "),n("kbd",[t._v("Cmd + R")]),t._v(")重启Extension Development Host，或者直接按VS Code上面的重启按钮")]),t._v(" "),n("p",[t._v("新建一个文件，输入一些文本然后选中。当你运行"),n("strong",[t._v("Hello World")]),t._v("命令，你应该能看到字符计数的消息框。")]),t._v(" "),n("p",[n("img",{attrs:{src:"https://raw.githubusercontent.com/Microsoft/vscode-docs/master/docs/extensions/images/example-hello-world/selection-length.png",alt:"文字计数"}})]),t._v(" "),n("h2",{attrs:{id:"在本地安装你的插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在本地安装你的插件"}},[t._v("#")]),t._v(" 在本地安装你的插件")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("好了，现在你已经完成了一个运行在开发模式下的插件，为了让你的插件运行在所有VS Code实例中，你需要在本地插件目录下新建一个文件夹，然后复制过去：")]),t._v(" "),n("ul",[n("li",[t._v("Windows: "),n("code",[t._v("%USERPROFILE%\\.vscode\\extensions")])]),t._v(" "),n("li",[t._v("macOS/Linux: "),n("code",[t._v("$HOME\\.vscode\\extensions")])])]),t._v(" "),n("h2",{attrs:{id:"发布插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#发布插件"}},[t._v("#")]),t._v(" 发布插件")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("参阅"),n("RouterLink",{attrs:{to:"/extension-authoring/publish-extension.html"}},[t._v("分享插件")])],1),t._v(" "),n("h2",{attrs:{id:"下一步"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#下一步"}},[t._v("#")]),t._v(" 下一步")]),t._v(" "),n("hr"),t._v(" "),n("p",[t._v("在本篇指引中，我们实现了一个小小的插件。在"),n("RouterLink",{attrs:{to:"/extension-authoring/docs/extension-authoring/example-word-count.html"}},[t._v("示例-Word Count")]),t._v("中你能找到完整的例子，学习如何在Markdown文件中监听编辑器的文档变动事件、显示文本字数。")],1),t._v(" "),n("p",[t._v("如果你想查看更多extension API的概述，看看这些主题吧：")]),t._v(" "),n("ul",[n("li",[n("RouterLink",{attrs:{to:"/extensibility-reference/overview.html"}},[t._v("Extension API 概览")]),t._v(" - 了解完整的VS Code扩展性模型。")],1),t._v(" "),n("li",[n("RouterLink",{attrs:{to:"/extensibility-reference/principles-patterns.html"}},[t._v("API原则和模式")]),t._v(" - VS Code的扩展性基于这些指导性原则和模式。")],1),t._v(" "),n("li",[n("RouterLink",{attrs:{to:"/extensibility-reference/contribution-points.html"}},[t._v("发布内容配置")]),t._v(" - 各种各样的VS Code发布内容配置项")],1),t._v(" "),n("li",[n("RouterLink",{attrs:{to:"/extensibility-reference/activation-events.html"}},[t._v("激活事件")]),t._v(" - VS Code激活事件参考")],1),t._v(" "),n("li",[n("RouterLink",{attrs:{to:"/extension-authoring/samples.html"}},[t._v("更多插件示例")]),t._v(" - 看看我们的插件示例列表")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);