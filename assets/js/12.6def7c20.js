(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{358:function(t,e,a){"use strict";a.r(e);var n=a(42),s=Object(n.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"激活事件-package-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#激活事件-package-json"}},[t._v("#")]),t._v(" 激活事件 - package.json")]),t._v(" "),a("p",[t._v("在VS Code中，插件都是懒加载的，所以你得为VS Code提供插件激活的时机。 我们提供了下列激活时机：")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"extensibility-reference/activation-events#activationeventsonlanguage"}},[a("code",[t._v("onLanguage:${language}")])])]),t._v(" "),a("li",[a("a",{attrs:{href:"extensibility-reference/activation-events#activationeventsoncommand"}},[a("code",[t._v("onCommand:${command}")])])]),t._v(" "),a("li",[a("a",{attrs:{href:"extensibility-reference/activation-events#activationeventsondebug"}},[a("code",[t._v("onDebug")])])]),t._v(" "),a("li",[a("a",{attrs:{href:"extensibility-reference/activation-events#activationeventsworkspacecontains"}},[a("code",[t._v("workspaceContains:${toplevelfilename}")])])]),t._v(" "),a("li",[a("a",{attrs:{href:"extensibility-reference/activation-events#activationeventsonfilesystem"}},[a("code",[t._v("onFileSystem:${scheme}")])])]),t._v(" "),a("li",[a("a",{attrs:{href:"extensibility-reference/activation-events#activationeventsonview"}},[a("code",[t._v("onView:${viewId}")])])]),t._v(" "),a("li",[a("a",{attrs:{href:"extensibility-reference/activation-events#activationeventsonuri"}},[a("code",[t._v("onUri")])])]),t._v(" "),a("li",[a("a",{attrs:{href:"extensibility-reference/activation-events#activationevents"}},[a("code",[t._v("*")])])])]),t._v(" "),a("p",[t._v("我们在"),a("RouterLink",{attrs:{to:"/extensibility-reference/extensibility-reference/extension-manifest.html"}},[a("code",[t._v("package.json")]),t._v(" 插件清单")]),t._v("中提供了一个插件最少所需的激活事件。")],1),t._v(" "),a("h2",{attrs:{id:"activationevents-onlanguage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#activationevents-onlanguage"}},[t._v("#")]),t._v(" activationEvents.onLanguage")]),t._v(" "),a("p",[t._v("特定语言文件打开时激活：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("...\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"activationEvents"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onLanguage:python"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n...\n")])])]),a("p",[a("code",[t._v("onLanguage")]),t._v("只支持"),a("RouterLink",{attrs:{to:"/docs/languages/identifiers.html"}},[t._v("语言标识符")]),t._v("中的值。")],1),t._v(" "),a("p",[t._v("在"),a("code",[t._v("activationEvents")]),t._v("数组中声明多个"),a("code",[t._v("onLanguage")]),t._v("入口实现多语言支持")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"activationEvents"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onLanguage:json"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onLanguage:markdown"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onLanguage:typescript"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n...\n")])])]),a("h2",{attrs:{id:"activationevents-oncommand"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#activationevents-oncommand"}},[t._v("#")]),t._v(" activationEvents.onCommand")]),t._v(" "),a("p",[t._v("当调用命令时激活事件：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("...\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"activationEvents"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onCommand:extension.sayHello"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n...\n")])])]),a("h2",{attrs:{id:"activationevents-ondebug"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#activationevents-ondebug"}},[t._v("#")]),t._v(" activationEvents.onDebug")]),t._v(" "),a("p",[t._v("调试会话（debug session）启动前激活：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("...\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"activationEvents"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onDebug"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n...\n")])])]),a("h3",{attrs:{id:"ondebuginitialconfigurations-and-ondebugresolve"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ondebuginitialconfigurations-and-ondebugresolve"}},[t._v("#")]),t._v(" onDebugInitialConfigurations and onDebugResolve")]),t._v(" "),a("p",[t._v("这是两个粒度更细的激活事件：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("onDebugInitialConfigurations")]),t._v(" 在"),a("code",[t._v("DebugConfigurationProvider")]),t._v("中的 "),a("code",[t._v("provideDebugConfigurations")]),t._v("方法之前触发。")]),t._v(" "),a("li",[a("code",[t._v("onDebugResolve:type")]),t._v(" 在"),a("code",[t._v("DebugConfigurationProvider")]),t._v("的"),a("code",[t._v("resolveDebugConfiguration")]),t._v("方法之前触发。")])]),t._v(" "),a("p",[a("strong",[t._v("首要原则：")]),t._v(" 如果调试插件的激活事件比较轻量，那么就用"),a("code",[t._v("onDebug")]),t._v("。相反，根据"),a("code",[t._v("DebugConfigurationProvider")]),t._v("实现的对应方法（ "),a("code",[t._v("provideDebugConfigurations")]),t._v("或"),a("code",[t._v("resolveDebugConfiguration")]),t._v("），使用"),a("code",[t._v("onDebugInitialConfigurations")]),t._v("或"),a("code",[t._v("onDebugResolve")]),t._v(" 。参见 "),a("RouterLink",{attrs:{to:"/docs/extensionAPI/api-debugging.html#debug-type-specific-hooks"}},[t._v("Debug Type specific Hooks")]),t._v("。")],1),t._v(" "),a("h2",{attrs:{id:"activationevents-workspacecontains"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#activationevents-workspacecontains"}},[t._v("#")]),t._v(" activationEvents.workspaceContains")]),t._v(" "),a("p",[t._v("文件夹打开后，且文件夹中至少包含一个符合glob模式的文件时触发。")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("...\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"activationEvents"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"workspaceContains:**/.editorconfig"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n...\n")])])]),a("h2",{attrs:{id:"activationevents-onfilesystem"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#activationevents-onfilesystem"}},[t._v("#")]),t._v(" activationEvents.onFileSystem")]),t._v(" "),a("p",[t._v("从*协议（scheme）*打开的文件或文件夹打开时触发。通常是"),a("code",[t._v("file")]),t._v("-协议，也可以用自定义的文件供应器函数替换掉，比如"),a("code",[t._v("ftp")]),t._v("、"),a("code",[t._v("ssh")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("...\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"activationEvents"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onFileSystem:sftp"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n...\n")])])]),a("h2",{attrs:{id:"activationevents-onview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#activationevents-onview"}},[t._v("#")]),t._v(" activationEvents.onView")]),t._v(" "),a("p",[t._v("指定的视图id展开时触发：")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("...\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"activationEvents"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onView:nodeDependencies"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n...\n")])])]),a("h2",{attrs:{id:"activationevents-onuri"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#activationevents-onuri"}},[t._v("#")]),t._v(" activationEvents.onUri")]),t._v(" "),a("p",[t._v("插件的系统级URI打开时触发。这个URI协议需要带上"),a("code",[t._v("vscode")]),t._v(" 或者 "),a("code",[t._v("vscode-insiders")]),t._v("协议。URI授权必须是插件的唯一标识，剩余的URI是可选的。")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("...\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"activationEvents"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"onUri"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n...\n")])])]),a("p",[t._v("如果 "),a("code",[t._v("vscode.git")]),t._v("插件定义了"),a("code",[t._v("onUri")]),t._v("激活事件，那么下列任意URI打开时就会触发：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("vscode://vscode.git/init")])]),t._v(" "),a("li",[a("code",[t._v("vscode://vscode.git/clone?url=https%3A%2F%2Fgithub.com%2FMicrosoft%2Fvscode-vsce.git")])]),t._v(" "),a("li",[a("code",[t._v("vscode-insiders://vscode.git/init")]),t._v(" (for VS Code Insiders)")])]),t._v(" "),a("h2",{attrs:{id:"activationevents"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#activationevents"}},[t._v("#")]),t._v(" activationEvents.*")]),t._v(" "),a("p",[t._v("当VS Code启动时触发。为了保证良好的用户体验，只在你的插件没有其他任何激活事件的前提下，添加这个激活事件。")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("...\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"activationEvents"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n...\n")])])]),a("p",[t._v("!> "),a("strong",[t._v("注意：")]),t._v(" 一个插件如果侦听了多个激活事件，那么最好用"),a("code",[t._v('"*"')]),t._v("替换掉。")]),t._v(" "),a("p",[t._v("!> "),a("strong",[t._v("注意：")]),t._v(" 插件"),a("strong",[t._v("必须")]),t._v("从它的主模块中输出一个"),a("code",[t._v("activate()")]),t._v("函数，当任意的激活事件触发时，VS Code会"),a("strong",[t._v("仅仅调用一次这个函数")]),t._v("。此外，插件也"),a("strong",[t._v("应该")]),t._v(" 导出一个"),a("code",[t._v("deactivate()")]),t._v("函数，当VS Code关闭时执行清理的任务。如果清理进程是异步的，插件的"),a("code",[t._v("deactivate()")]),a("strong",[t._v("必须")]),t._v("返回一个Promise。如果这个清理任务是同步的，那么"),a("code",[t._v("deactivate()")]),t._v("可以返回"),a("code",[t._v("undefined")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"下一步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下一步"}},[t._v("#")]),t._v(" 下一步")]),t._v(" "),a("p",[t._v("学习更多VS Code扩展性模型，看看下列主题：")]),t._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/docs/extensionAPI/extension-manifest.html"}},[t._v("插件清单")]),t._v(" - VS Code package.json 插件清单文件参考")],1),t._v(" "),a("li",[a("RouterLink",{attrs:{to:"/docs/extensionAPI/extension-points.html"}},[t._v("发布内容配置点")]),t._v(" - VS Code 发布内容配置点参考")],1)])])}),[],!1,null,null,null);e.default=s.exports}}]);