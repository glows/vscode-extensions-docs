(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{368:function(t,s,a){"use strict";a.r(s);var e=a(42),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"复杂命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#复杂命令"}},[t._v("#")]),t._v(" 复杂命令")]),t._v(" "),a("p",[t._v("本篇列出了VS Code中一系列的复杂命令。因为这些命令需要参数，还会返回一些值，所以我们称之为复杂命令。你可以通过"),a("code",[t._v("executeCommand")]),t._v("API，将各个命令联合起来使用。")]),t._v(" "),a("p",[t._v("下面是一个预览HTML文档的例子：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" uri "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Uri"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'file:///some/path/to/file.html'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" success "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" commands"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("executeCommand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vscode.previewHtml'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uri"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[t._v("#")]),t._v(" 命令")]),t._v(" "),a("hr"),t._v(" "),a("p",[a("code",[t._v("vscode.executeWorkspaceSymbolProvider")]),t._v(" - 执行工作区全部的符号供应函数（symbol provider）")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("query")]),t._v(" - 搜索文本")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回SymbolInformation实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeDefinitionProvider")]),t._v(" - 执行全部定义供应函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("position")]),t._v(" - 某个符号的位置")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回Location实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeTypeDefinitionProvider")]),t._v(" - 执行全部的定义供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("position")]),t._v(" - 某个符号的位置")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回Location实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeImplementationProvider")]),t._v(" - 执行全部的"),a("strong",[t._v("实现")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("position")]),t._v(" - 某个符号的位置")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回Location实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeHoverProvider")]),t._v(" - 执行全部的"),a("strong",[t._v("悬浮提示")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("position")]),t._v(" - 某个符号的位置")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回Hover实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeDocumentHighlights")]),t._v(" -  执行"),a("strong",[t._v("文档高亮")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("position")]),t._v(" - 某个符号的位置")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回DocumentHighlight实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeReferenceProvider")]),t._v(" - 执行"),a("strong",[t._v("引用")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("position")]),t._v(" - 某个符号的位置")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回Location实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeDocumentRenameProvider")]),t._v(" - 执行"),a("strong",[t._v("重命名")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("position")]),t._v(" - 某个符号的位置")]),t._v(" "),a("li",[a("em",[t._v("newName")]),t._v(" - 新符号的名称")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回WorkspaceEdit")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeSignatureHelpProvider")]),t._v(" - 执行"),a("strong",[t._v("符号帮助")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("position")]),t._v(" - 某个符号的位置")]),t._v(" "),a("li",[a("em",[t._v("triggerCharacter")]),t._v(" - (可选) 当用户输入特定字符时（如"),a("code",[t._v(",")]),t._v(" 或 "),a("code",[t._v("(")]),t._v("）触发符号帮助")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回SignatureHelp")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeDocumentSymbolProvider")]),t._v(" - 执行"),a("strong",[t._v("文档符号")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回SymbolInformation实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeCompletionItemProvider")]),t._v(" - 执行"),a("strong",[t._v("补全")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("position")]),t._v(" - 某个符号的位置")]),t._v(" "),a("li",[a("em",[t._v("triggerCharacter")]),t._v(" - (可选) 当用户输入特定字符时（如"),a("code",[t._v(",")]),t._v(" 或 "),a("code",[t._v("(")]),t._v("）触发符号帮助")]),t._v(" "),a("li",[a("em",[t._v("itemResolveCount")]),t._v(" - (可选) 解析的补全数量 (该数字太大会减慢补全项解析的过程)")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回CompletionList实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeCodeActionProvider")]),t._v(" - 执行"),a("strong",[t._v("代码激活")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("range")]),t._v(" - 文本文档的范围")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回Command实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeCodeLensProvider")]),t._v(" - 执行CodeLens供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("itemResolveCount")]),t._v(" - (可选) 解析的结果数量，该配置可能会影响性能")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回CodeLens实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeFormatDocumentProvider")]),t._v(" - 执行"),a("strong",[t._v("文档格式化")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("position")]),t._v(" - 某个符号的位置")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回TextEdits实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeFormatRangeProvider")]),t._v(" - 执行"),a("strong",[t._v("范围格式化")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("range")]),t._v(" - 文本文档的范围")]),t._v(" "),a("li",[a("em",[t._v("options")]),t._v(" - 格式化选项")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回TextEdits实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeFormatOnTypeProvider")]),t._v(" - 执行"),a("strong",[t._v("文档格式化")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("position")]),t._v(" - 某个符号的位置")]),t._v(" "),a("li",[a("em",[t._v("ch")]),t._v(" - 输入的字符")]),t._v(" "),a("li",[a("em",[t._v("options")]),t._v(" - 格式化选项")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回TextEdits实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeLinkProvider")]),t._v(" - 执行"),a("strong",[t._v("文档链接")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - * "),a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回DocumentLink实例数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeDocumentColorProvider")]),t._v(" - 执行"),a("strong",[t._v("文档色彩")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 文档的Uri")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回ColorInformation对象数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.executeColorPresentationProvider")]),t._v(" - 执行"),a("strong",[t._v("色彩呈现")]),t._v("供应器函数。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("color")]),t._v(" - 要显示和插入的颜色")]),t._v(" "),a("li",[a("em",[t._v("context")]),t._v(" - 上下文对象，包含uri和影响范围")]),t._v(" "),a("li",[a("em",[t._v("(returns)")]),t._v(" - promise函数，且返回ColorPresentation对象数组")])]),t._v(" "),a("p",[a("code",[t._v("vscode.previewHtml")]),t._v(" - 在编辑器窗口中渲染HTML")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - 要预览的Uri")]),t._v(" "),a("li",[a("em",[t._v("column")]),t._v(" - (可选) 显示在窗口的哪一列")]),t._v(" "),a("li",[a("em",[t._v("label")]),t._v(" - (可选) 字符串，显示为预览的标题")]),t._v(" "),a("li",[a("em",[t._v("options")]),t._v(" - (可选) 控制webivew环境的选项")])]),t._v(" "),a("p",[t._v("查看 "),a("a",{attrs:{href:"extensibility-reference/vscode-api-commands?id=%E4%BD%BF%E7%94%A8html-preview"}},[t._v("使用HTML预览")]),t._v("章节获取更多最佳实践和插件创作的信息。")]),t._v(" "),a("p",[a("code",[t._v("vscode.openFolder")]),t._v(" - 在当前工作区打开文件夹，或者根据传入的参数打开新窗口")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("uri")]),t._v(" - (可选) 要打开的文件夹或者工作区文件。如果不提供的话，会打开一个原生对话框窗口给用户选择。")]),t._v(" "),a("li",[a("em",[t._v("newWindow")]),t._v(" - (可选) 是否在新窗口中打开文件夹/工作区。默认在当前窗口打开。")])]),t._v(" "),a("p",[t._v("!> 注意：在当前窗口打开会关闭当前插件进程，然后根据新的文件夹/工作区启动新的插件进程，除非你配置了newWindow参数")]),t._v(" "),a("p",[a("code",[t._v("vscode.diff")]),t._v(" - 在diff编辑器中打开选中的源文件以便比较他们的内容。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("left")]),t._v(" - diff编辑器左边的文件")]),t._v(" "),a("li",[a("em",[t._v("right")]),t._v(" - diff编辑器右边的文件")]),t._v(" "),a("li",[a("em",[t._v("title")]),t._v(" - (可选) diff编辑器的标题")]),t._v(" "),a("li",[a("em",[t._v("options")]),t._v(" - (可选) 编辑器选项，请查看vscode.TextDocumentShowOptions")])]),t._v(" "),a("p",[a("code",[t._v("vscode.open")]),t._v(" - 在编辑器中打开提供的资源文件")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("resource")]),t._v(" - 要打开的资源文件")]),t._v(" "),a("li",[a("em",[t._v("columnOrOptions")]),t._v(" - (可选) 可以是要打开的编辑器列，也可以是编辑器选项，查看 vscode.TextDocumentShowOptions")])]),t._v(" "),a("p",[t._v("可以是文本文件、二进制文件、http(s) url。如果你需要打开文本文件时的更多控制，请使用vscode.window.showTextDocument")]),t._v(" "),a("p",[a("code",[t._v("vscode.removeFromRecentlyOpened")]),t._v(" - 在最近打开的列表中移除一个路径。")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("path")]),t._v(" - 路径")])]),t._v(" "),a("p",[a("code",[t._v("vscode.setEditorLayout")]),t._v(" - 设置编辑器的布局")]),t._v(" "),a("ul",[a("li",[a("em",[t._v("layout")]),t._v(" - 要设置的布局")])]),t._v(" "),a("p",[t._v("布局是一个对象，带有初始布局方向（可选，0 = 水平布局，1 = 垂直布局），还有一个包含编辑器组的数组。每个编辑器组又有一个尺寸和另一个数组，其中有矩形布局和方向信息。如果设置了编辑器组的大小，每一行或者每一列的总和必须为1。比如一个2x2的网格："),a("code",[t._v("{ orientation: 0, groups: [{ groups: [{}, {}], size: 0.5 }, { groups: [{}, {}], size: 0.5 }] }")])]),t._v(" "),a("p",[a("code",[t._v("cursorMove")]),t._v(" - 将鼠标指针移动到视图的逻辑位置上。")]),t._v(" "),a("ul",[a("li",[a("p",[a("em",[t._v("Cursor move argument object")])]),t._v(" "),a("p",[t._v("这个参数可以配置以下键值对：")]),t._v(" "),a("ul",[a("li",[t._v("'to': 必须，鼠标要移动到的逻辑坐标值"),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("'left', 'right', 'up', 'down'\n'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'\n'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'\n'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'\n")])])])]),t._v(" "),a("li",[t._v("'by': 移动的单位，默认根据'to'值计算"),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("'line', 'wrappedLine', 'character', 'halfLine'\n")])])])]),t._v(" "),a("li",[t._v("'value': 步进数。默认为'1'")]),t._v(" "),a("li",[t._v("'select': 设为'true'时则选中文本。默认是 'false'")])])])]),t._v(" "),a("p",[a("code",[t._v("editorScroll")]),t._v(" - 给定方向，滚动编辑器")]),t._v(" "),a("ul",[a("li",[a("p",[a("em",[t._v("Editor scroll argument object")])]),t._v(" "),a("p",[t._v("这个参数可以配置以下键值对：")]),t._v(" "),a("ul",[a("li",[t._v("'to': 必须，方向的值"),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("'up', 'down'\n")])])])]),t._v(" "),a("li",[t._v("'by': 移动的单位。默认根据'to'值计算。"),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("'line', 'wrappedLine', 'page', 'halfPage'\n")])])])]),t._v(" "),a("li",[t._v("'value': 步进数。默认为'1'")]),t._v(" "),a("li",[t._v("'revealCursor': 如果设为'true'，那么滚动超出视口时也显示鼠标.")])])])]),t._v(" "),a("p",[a("code",[t._v("revealLine")]),t._v(" - 根据给定的逻辑位置显示行")]),t._v(" "),a("ul",[a("li",[a("p",[a("em",[t._v("Reveal line argument object")])]),t._v(" "),a("p",[t._v("这个参数可以配置以下键值对：")]),t._v(" "),a("ul",[a("li",[t._v("'lineNumber': 必须，行数")]),t._v(" "),a("li",[t._v("'at': 显示行的逻辑位置"),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("'top', 'center', 'bottom'\n")])])])])])])]),t._v(" "),a("p",[a("code",[t._v("editor.unfold")]),t._v(" - 展开编辑器中的内容")]),t._v(" "),a("ul",[a("li",[a("p",[a("em",[t._v("Unfold editor argument")])]),t._v(" "),a("p",[t._v("这个参数可以配置以下键值对：")]),t._v(" "),a("ul",[a("li",[t._v("'levels': 展开的层级数。默认为1")]),t._v(" "),a("li",[t._v("'direction': 如果设置为'up'，向上展开，不然向下展开")]),t._v(" "),a("li",[t._v("'selectionLines': 要使用展开功能的起始行（从0起）。如果不设置，就会使用当前激活的行（选中区）.")])])])]),t._v(" "),a("p",[a("code",[t._v("editor.fold")]),t._v(" - 折叠编辑器中的内容")]),t._v(" "),a("ul",[a("li",[a("p",[a("em",[t._v("Fold editor argument")])]),t._v(" "),a("p",[t._v("这个参数可以配置以下键值对：")]),t._v(" "),a("ul",[a("li",[t._v("'levels': 折叠的的层级数。默认为1")]),t._v(" "),a("li",[t._v("'direction': 如果设置为'up'，向上折叠，不然向下折叠")]),t._v(" "),a("li",[t._v("'selectionLines': 要使用折叠功能的起始行（从0起）。如果不设置，就会使用当前激活的行（选中区）.")])]),t._v(" "),a("p",[a("code",[t._v("editor.action.showReferences")]),t._v(" - 在同个文件中显示引用的位置")])]),t._v(" "),a("li",[a("p",[a("em",[t._v("uri")]),t._v(" - 要实现引用的文件")])]),t._v(" "),a("li",[a("p",[a("em",[t._v("position")]),t._v(" - 要显示的位置")])]),t._v(" "),a("li",[a("p",[a("em",[t._v("locations")]),t._v(" - 位置数组")])])]),t._v(" "),a("p",[a("code",[t._v("moveActiveEditor")]),t._v(" - 依据标签或者组移动激活的编辑器")]),t._v(" "),a("ul",[a("li",[a("p",[a("em",[t._v("Active editor move argument")])]),t._v(" "),a("p",[t._v("参数值：")]),t._v(" "),a("ul",[a("li",[t._v("'to': String")]),t._v(" "),a("li",[t._v("'by': String，移动的单位（标签：'tab'，组：'group'）")]),t._v(" "),a("li",[t._v("'value': Number，要移动的位置或者绝对位置值")])])])]),t._v(" "),a("h2",{attrs:{id:"使用html-preview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用html-preview"}},[t._v("#")]),t._v(" 使用HTML Preview")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"样式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#样式"}},[t._v("#")]),t._v(" 样式")]),t._v(" "),a("p",[t._v("VS Code会动态解析HTML 的Body元素，加上下列类标签"),a("code",[t._v("vscode-light")]),t._v("，"),a("code",[t._v("vscode-dark")]),t._v("，"),a("code",[t._v("vscode-high-contrast")]),t._v("，以便符合VS Code当前的主题。")]),t._v(" "),a("h3",{attrs:{id:"链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#链接"}},[t._v("#")]),t._v(" 链接")]),t._v(" "),a("p",[t._v("文档中的链接是VS Code来处理的，VS Code也支持"),a("code",[t._v("file")]),t._v("和"),a("a",{attrs:{href:"https://github.com/Microsoft/vscode/blob/master/src/vs/vscode.d.ts#L3295",target:"_blank",rel:"noopener noreferrer"}},[t._v("virtual"),a("OutboundLink")],1),t._v("资源，还可以通过"),a("code",[t._v("command")]),t._v("协议触发命令。使用JSON格式的参数传入command-uri。注意：URL必须要encode。")]),t._v(" "),a("p",[t._v("下面的片段展示了一个命令的链接形式:")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" href "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("encodeURI")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'command:vscode.previewHtml?'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("someUri"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" html "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<a href=\"'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" href "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\">Show Resource...</a>.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"安全性小贴士"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安全性小贴士"}},[t._v("#")]),t._v(" 安全性小贴士")]),t._v(" "),a("p",[t._v("作为插件的创作者，如果你使用了HTML预览，那么你就要避免用户接触到恶意内容。最危险的是攻击者使用你的HTML预览伪造了一个工作区，然后执行脚本和一些不安全的行为。遵循WEB安全的最佳实践，下面的内容有助于保护用户。")]),t._v(" "),a("h4",{attrs:{id:"审查内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#审查内容"}},[t._v("#")]),t._v(" 审查内容")]),t._v(" "),a("p",[t._v("作为防御的第一条，当你使用HTML预览时，请先审查来自工作区设置或者用户的文件系统的输入内容。对于HTML内容，最好使用安全的tag和attribute白名单。使用"),a("a",{attrs:{href:"https://www.npmjs.com/package/sanitize-html",target:"_blank",rel:"noopener noreferrer"}},[t._v("sanitize-html"),a("OutboundLink")],1),t._v("库可以帮到你。")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("iframe")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("sandbox")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("srcdoc")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("<!DOCTYPE html>..."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("iframe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("如果你的预览需要一些本机内容，用 "),a("code",[t._v('sandbox="allow-same-origin"')]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("iframe")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("sandbox")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("allow-same-origin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("srcdoc")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("<!DOCTYPE html>..."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("iframe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[a("code",[t._v('sandbox="allow-same-origin"')]),t._v(" 禁用了"),a("code",[t._v("iframe")]),t._v("内的脚本执行，不过允许加载用户的本机内容，比如样式和图片。最好还是禁用所有本机资源访问，除非你确实需要加载一些东西。")]),t._v(" "),a("h4",{attrs:{id:"使用内容安全协议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用内容安全协议"}},[t._v("#")]),t._v(" 使用内容安全协议")]),t._v(" "),a("p",[t._v("如果你的预览需要一些脚本，请使用"),a("a",{attrs:{href:"https://developer.mozilla.org/docs/Web/HTTP/CSP",target:"_blank",rel:"noopener noreferrer"}},[t._v("content security policy"),a("OutboundLink")],1),t._v("禁用掉来自非可信用户的脚本。")]),t._v(" "),a("p",[t._v("比如，下面的内容保护协议允许了任意来源的图片，用户本地的样式，但是禁用了全部脚本:")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token doctype"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),a("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("en"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http-equiv")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Content-Security-Policy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("default-src "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("; img-src *; style-src "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("; script-src "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v(";"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("..."),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  Content\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("要想选择性地启动脚本，最好的方法是为白名单脚本动态生成"),a("a",{attrs:{href:"https://developers.google.com/web/fundamentals/security/csp/",target:"_blank",rel:"noopener noreferrer"}},[t._v("nonce"),a("OutboundLink")],1),t._v("：")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token doctype"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),a("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("en"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http-equiv")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("Content-Security-Policy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("default-src "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("; img-src *; style-src "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("; script-src "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v("nonce-123456"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v(";"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("..."),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  Content\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("nonce")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("123456"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("file:///path/to/extension/my_trusted_script.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);